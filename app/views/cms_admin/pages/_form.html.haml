- content_for :right_column do
  #form-save.box
    %label.checkbox.inline
      %input{:type => 'checkbox'}
      = Cms::Page.human_attribute_name(:is_published)
    %button.btn.btn-small.btn-primary.pull-right
  = render :partial => 'cms_admin/files/index'

= form.text_field :label, :data => {:slugify => @page.new_record?}

- unless @site.pages.count == 0 || @site.pages.root == @page
  = form.text_field :slug, :data => {:slug => true}
  - unless @page.new_record?
    = form.text_field :full_path, :id => 'full-path', :disabled => true

- if (options = Cms::Layout.options_for_select(@site)).present?
  = form.select :layout_id, options, {}, 'data-url' => form_blocks_cms_admin_site_page_path(@site, @page.id.to_i)
  
- if (options = Cms::Page.options_for_select(@site, @page)).present?
  = form.select :parent_id, options

- if (options = Cms::Page.options_for_select(@site, @page, nil, 0, false)).present?
  = form.select :target_page_id, [["---- #{t('.select_target_page')} ----", nil]] + options

= cms_hook :page_form, :object => form

= render :partial => 'cms_admin/categories/form', :object => form

- if ComfortableMexicanSofa.config.variations.present?
  = form.element 'Variations' do
    - ComfortableMexicanSofa.config.variations.each do |identifier|
      %label
        - checked = @page.page_content.variations.detect{|v| v.identifier == identifier.to_s}.present?
        - name = "page[page_content_attributes][variation_identifiers][#{identifier}]"
        = hidden_field_tag name, '0'

        - disabled = @page.page_contents.for_variation(identifier).where('cms_page_contents.id NOT IN (?)', (@page.page_content.id || 0)).exists?
        = check_box_tag name, '1', checked, :id => false, :disabled => disabled

        %span= identifier

= form.fields_for :page_content, @page.page_content do |pc|
  = pc.text_field :slug
  = pc.hidden_field :id

= render :partial => 'form_blocks'

= form.check_box :is_published, :label => t('.is_published')

.form-actions
  = form.submit t('.preview'), :name => 'preview', :id => nil, :class => 'btn'
  = form.submit t(@page.new_record?? '.create' : '.update'), :class => 'btn btn-primary'